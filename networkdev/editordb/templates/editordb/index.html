{% extends 'editordb/base_editordb.html' %}


{% block title %}
    All Devices
{% endblock %}


{% block content %}

    <form action="{% url "add_device_url" %}">
        <button type="submit" class=" btn btn-dark ">Add new device</button>
    </form>

    {% if crontab is None %}

    <form action="{% url "add_crontab_url" %}">
        <button type="submit" class=" btn btn-dark ">Add crontab</button>
    </form>

    {% else %}

    <form action="{% url "update_crontab_url" %}">
      <button type="submit" class=" btn btn-dark ">Update crontab</button>
    </form>

    {% endif %}


    {% if devices.object_list.count > 0 %}

        <h2>DEVICES LIST</h2>
        <table class="table table-sm">
            <thead><th scope="col">IP address</th><th scope="col">Login</th><th scope="col">Password</th><th scope="col">Production</th><th scope="col">Connection type</th><th></th></thead>

        {% for device in devices.object_list %}

            <tr>
                <td scope="row">{{ device.ip_address }}</td>
                <td scope="row">{{ device.login }}</td>
                <td scope="row">{{ device.password }}</td>
                <td scope="row">{{ device.production }}</td>
                <td scope="row">{{ device.connection_type }}</td>
                <td><a href="{{device.id}}/update_device" class="btn btn-dark">Edit</a> | <a href="{{device.id}}/delete_device" class="btn btn-dark">Delete</a></td>
            </tr>

        {% endfor %}
        </table>

    {% endif %}

    {% if is_paginated%}

    <nav aria-label="...">
      <ul class="pagination justify-content-center">
        <li class="page-item {% if not prev_url %} disabled {% endif %}">
          <a class="page-link" href="{{ prev_url }}" tabindex="-1" aria-disabled="true" class="btn-dark">Previous</a>
        </li>


        {% for n in devices.paginator.page_range %}

            {% if devices.number == n %}

                <li class="page-item active" aria-current="page">
                  <a class="page-link" href="?page={{ n }}">{{ n }}<span class="sr-only">(current)</span></a>
                </li>

            {% elif n > devices.number|add:-3 and n < devices.number|add:3  %}
                <li class="page-item">
                  <a class="page-link" href="?page={{ n }}">{{ n }}</a>
                </li>
            {% endif %}


        {% endfor %}

        <li class="page-item {% if not next_url %} disabled {% endif %}">
          <a class="page-link" href="{{ next_url }}">Next</a>
        </li>
      </ul>
    </nav>

    {% endif %}



{% endblock %}
